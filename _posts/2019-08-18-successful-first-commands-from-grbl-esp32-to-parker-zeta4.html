---
layout: post
title: Successful First Commands From Grbl ESP32 To Parker ZETA4
date: 2019-08-18 12:30:30.000000000 +00:00
type: post
post_id: '19213'
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Projects
tags:
- XY Stage
meta:
  _thumbnail_id: '19214'
  _oembed_e207cec343a70a21906a8acaa1019047: '<div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">Tonight
    at <a href="https://twitter.com/hashtag/SGVHAK?src=hash&amp;ref_src=twsrc%5Etfw">#SGVHAK</a>:
    decades old industrial stepper motor takes orders from modern darling ESP32 running
    GRBL. <a href="https://t.co/P1A4GZ945h">pic.twitter.com/P1A4GZ945h</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1161094071437279232?ref_src=twsrc%5Etfw">August
    13, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>'
  _oembed_time_e207cec343a70a21906a8acaa1019047: '1565820506'
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  timeline_notification: '1566156704'
  _oembed_486741dc39e111c8392119057a647345: '<div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Tonight
    at <a href="https://twitter.com/hashtag/SGVHAK?src=hash&amp;ref_src=twsrc%5Etfw">#SGVHAK</a>:
    decades old industrial stepper motor takes orders from modern darling ESP32 running
    GRBL. <a href="https://t.co/P1A4GZ945h">pic.twitter.com/P1A4GZ945h</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1161094071437279232?ref_src=twsrc%5Etfw">August
    13, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>'
  _oembed_time_486741dc39e111c8392119057a647345: '1566156702'
  _oembed_5c8a4430fbd3f8ebe98981d4ace66d30: '<div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Tonight
    at <a href="https://twitter.com/hashtag/SGVHAK?src=hash&amp;ref_src=twsrc%5Etfw">#SGVHAK</a>:
    decades old industrial stepper motor takes orders from modern darling ESP32 running
    GRBL. <a href="https://t.co/P1A4GZ945h">pic.twitter.com/P1A4GZ945h</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1161094071437279232?ref_src=twsrc%5Etfw">August
    13, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>'
  _publicize_job_id: '34250058734'
  _oembed_da62d14203f2235b3b46619dbe30f1d0: '<div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Tonight
    at <a href="https://twitter.com/hashtag/SGVHAK?src=hash&amp;ref_src=twsrc%5Etfw">#SGVHAK</a>:
    decades old industrial stepper motor takes orders from modern darling ESP32 running
    GRBL. <a href="https://t.co/P1A4GZ945h">pic.twitter.com/P1A4GZ945h</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1161094071437279232?ref_src=twsrc%5Etfw">August
    13, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>'
  _oembed_time_da62d14203f2235b3b46619dbe30f1d0: '1566156705'
  _oembed_time_5c8a4430fbd3f8ebe98981d4ace66d30: '1566156712'
  _oembed_bbc65a0ef1a4aed4aac8b0c90f8d0d4f: '<div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Tonight
    at <a href="https://twitter.com/hashtag/SGVHAK?src=hash&amp;ref_src=twsrc%5Etfw">#SGVHAK</a>:
    decades old industrial stepper motor takes orders from modern darling ESP32 running
    GRBL. <a href="https://t.co/P1A4GZ945h">pic.twitter.com/P1A4GZ945h</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1161094071437279232?ref_src=twsrc%5Etfw">August
    13, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>'
  _oembed_time_bbc65a0ef1a4aed4aac8b0c90f8d0d4f: '1708471098'
  _elasticsearch_data_sharing_indexed_on: '2024-11-18 13:25:19'
author:
  login: inkarc
  email: luxo.lamp@gmail.com
  display_name: Roger Cheng
  first_name: Roger
  last_name: Cheng
permalink: "/2019/08/18/successful-first-commands-from-grbl-esp32-to-parker-zeta4/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<html><body>
<p>Once I could bring <a href="https://newscrewdriver.com/2019/08/17/esp32-grbl-controller-breadboard-prototype/">my breadboard prototype Grbl ESP32 controller</a> into the shop where the salvaged XY stage lives, I was eager to hook up some wires to see if anything moves. While I put provisions for two axis on my breadboard, it felt like a good idea to start with just the X axis. It moved, but not accurately, because I had not configured the two components to match.</p>
<p>These stepper motors have 200 steps per revolution. ZETA4 controllers can easily handle full steps, but there are a lot of options for microsteps configurable with switches. The headache here is the lead screw: it is an old Imperial unit with a pitch of 5 revolutions per inch, but Grbl is a metric minded piece of software with everything in terms of millimeters. Using a conversion rate of 25.4 millimeters per inch, the most obvious ZETA4 microstep option that divided evenly is 25,400 steps per revolution.</p>
<p>The good news is that Grbl ESP32 appears fast enough to generate pulses at this speed, which is orders of magnitude beyond what I can generate with AccelStepper on an ATmega. But even with tests along a single axis, the system would halt at various times and I don't always understand why. For example: one of the halts gave an error of "Door Open" but Grbl configuration file explicitly said to ignore the door sensor switch, so why is it stopping motion? There are more to this system I don't yet understand.</p>
<p>So for the sake of eliminating potential problems, both the ZETA4 and ESP32 were configured for 2000 steps per revolution, or 10 micro steps in between whole steps. We know this is easily within the timing capabilities of the chip and, while it may introduce some error converting between Imperial and metric, it's not the biggest problem right now so we'll deal with it later.</p>
<p>These intermittent errors will likely continue as I run this system, and I will have to diagnose and debug as I go. In parallel with this, I've changed my plan: as my next step I will not connect the Y axis step/direction motion control pins. Instead, I will continue to refine X axis operation by <a href="https://newscrewdriver.com/2019/08/19/xy-stage-position-detection-switches/">getting position homing</a> to work.</p>
<p>https://twitter.com/Regorlas/status/1161094071437279232</p>
<p></body></html></p>
