---
layout: post
title: Arduino Interface for Mitutoyo SPC Data Port
date: 2020-09-22 12:30:00.000000000 +00:00
type: post
post_id: '22562'
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Arduino
- Projects
tags:
- Mitutoyo
meta:
  _thumbnail_id: '22277'
  _oembed_1ddbf960629b115c87e1e83f2dac880b: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">Oh
    yeah, now we&#39;re talking!<br>Mitutoyo SPC data translated to USB serial with
    Arduino code I&#39;ve published to <a href="https://t.co/BDOfrAFVmu">https://t.co/BDOfrAFVmu</a><br>Here
    USB serial data is plotted by a Node-RED dashboard chart widget. <a href="https://t.co/xnL1Lmf6nr">pic.twitter.com/xnL1Lmf6nr</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1289256790341763073?ref_src=twsrc%5Etfw">July
    31, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_1ddbf960629b115c87e1e83f2dac880b: '1600734358'
  _oembed_4e3cc70c09e4dd2fcdd2a6cf915fdf31: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="420" data-dnt="true"><p lang="en" dir="ltr">Oh
    yeah, now we&#39;re talking!<br>Mitutoyo SPC data translated to USB serial with
    Arduino code I&#39;ve published to <a href="https://t.co/BDOfrAFVmu">https://t.co/BDOfrAFVmu</a><br>Here
    USB serial data is plotted by a Node-RED dashboard chart widget. <a href="https://t.co/xnL1Lmf6nr">pic.twitter.com/xnL1Lmf6nr</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1289256790341763073?ref_src=twsrc%5Etfw">July
    31, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_519cf2bbbd58334ab801bbb895896541: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Oh
    yeah, now we&#39;re talking!<br>Mitutoyo SPC data translated to USB serial with
    Arduino code I&#39;ve published to <a href="https://t.co/BDOfrAFVmu">https://t.co/BDOfrAFVmu</a><br>Here
    USB serial data is plotted by a Node-RED dashboard chart widget. <a href="https://t.co/xnL1Lmf6nr">pic.twitter.com/xnL1Lmf6nr</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1289256790341763073?ref_src=twsrc%5Etfw">July
    31, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_519cf2bbbd58334ab801bbb895896541: '1600803086'
  _publicize_job_id: '49114321560'
  timeline_notification: '1600803087'
  _oembed_time_4e3cc70c09e4dd2fcdd2a6cf915fdf31: '1600803087'
  _oembed_9bc5f4427385b2ac28facdb483891c2a: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Oh
    yeah, now we&#39;re talking!<br>Mitutoyo SPC data translated to USB serial with
    Arduino code I&#39;ve published to <a href="https://t.co/BDOfrAFVmu">https://t.co/BDOfrAFVmu</a><br>Here
    USB serial data is plotted by a Node-RED dashboard chart widget. <a href="https://t.co/xnL1Lmf6nr">pic.twitter.com/xnL1Lmf6nr</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1289256790341763073?ref_src=twsrc%5Etfw">July
    31, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_9bc5f4427385b2ac28facdb483891c2a: '1600803088'
  _oembed_eddaa814de5087b289f24edcce0f2c0a: '<div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">I
    bought a Mitutoyo electronic indicator on faith that they&#39;re popular enough,
    I can find information online to interface with its data port. Turns out there&#39;s
    no need to hunt: the inbox pamphlet tells me how. I did not expect that! A very
    pleasant surprise. <a href="https://t.co/nvOCcgCb4h">pic.twitter.com/nvOCcgCb4h</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1287870898398064640?ref_src=twsrc%5Etfw">July
    27, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>'
  _oembed_time_eddaa814de5087b289f24edcce0f2c0a: '1600896828'
  _last_editor_used_jetpack: block-editor
  _oembed_f0fbee7d5c4dc495fd690c203dac180a: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Oh
    yeah, now we&#39;re talking!<br>Mitutoyo SPC data translated to USB serial with
    Arduino code I&#39;ve published to <a href="https://t.co/BDOfrAFVmu">https://t.co/BDOfrAFVmu</a><br>Here
    USB serial data is plotted by a Node-RED dashboard chart widget. <a href="https://t.co/xnL1Lmf6nr">pic.twitter.com/xnL1Lmf6nr</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1289256790341763073?ref_src=twsrc%5Etfw">July
    31, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_f0fbee7d5c4dc495fd690c203dac180a: '1608413338'
  wordads_ufa: s:wpcom-ufa-v3-beta:1666773491
  _oembed_4c393fd72dd5f96ab321930202a6ac51: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Oh
    yeah, now we&#39;re talking!<br>Mitutoyo SPC data translated to USB serial with
    Arduino code I&#39;ve published to <a href="https://t.co/BDOfrAFVmu">https://t.co/BDOfrAFVmu</a><br>Here
    USB serial data is plotted by a Node-RED dashboard chart widget. <a href="https://t.co/xnL1Lmf6nr">pic.twitter.com/xnL1Lmf6nr</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1289256790341763073?ref_src=twsrc%5Etfw">July
    31, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_4c393fd72dd5f96ab321930202a6ac51: '1708471148'
  _oembed_20e3d012c9772f2ed5458440ead0340e: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">Oh
    yeah, now we&#39;re talking!<br>Mitutoyo SPC data translated to USB serial with
    Arduino code I&#39;ve published to <a href="https://t.co/BDOfrAFVmu">https://t.co/BDOfrAFVmu</a><br>Here
    USB serial data is plotted by a Node-RED dashboard chart widget. <a href="https://t.co/xnL1Lmf6nr">pic.twitter.com/xnL1Lmf6nr</a></p>&mdash;
    Roger Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1289256790341763073?ref_src=twsrc%5Etfw">July
    31, 2020</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_20e3d012c9772f2ed5458440ead0340e: '1712086391'
  _elasticsearch_data_sharing_indexed_on: '2024-11-18 13:27:55'
author:
  login: inkarc
  email: luxo.lamp@gmail.com
  display_name: Roger Cheng
  first_name: Roger
  last_name: Cheng
permalink: "/2020/09/22/arduino-interface-for-mitutoyo-spc-data-port/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<!-- wp:paragraph --><html><body></p>
<p id="block-f0dc1185-a142-48fc-885b-3cdcb4cd2c74">I started looking for an inexpensive electronic indicator with digital output port, and ended up <a href="https://newscrewdriver.com/2020/09/21/mitutoyo-543-783b-indicator-with-spc-data-port/">splurging for a genuine Mitutoyo</a>. Sure it is over five times the cost of the Harbor Freight alternative, but I thought it would be worth the price for two reasons. One: Mitutoyo is known for high quality precision instruments, and two: they are popular enough that the data output port should be documented somewhere online.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The second point turned out to be moot because the data output port was actually documented by pamphlet in the box, no need to go hunting online. But I went online anyway to get a second opinion, and found <a rel="noreferrer noopener" href="https://www.instructables.com/id/Interfacing-a-Digital-Micrometer-to-a-Microcontrol/" target="_blank">this project on Instructables</a>. Most of the information matched up, but the wiring pinout specifically did not. Their cable schematic had a few apparent inconsistencies. (Example: one end of the cable had two ground pins and the other end did not.) They also had a "Menu" button that I lacked. These may just be the result of different products, but in any case it is information on the internet to be taken with a grain of salt. I took a meter to my own cable to ensure I have the pinout described by the pamphlet in my own instrument.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p id="block-a80a74ee-4084-44a3-b580-c5e3ea7433e3">Their Arduino code matched the pamphlet description, so I took that code as a starting point. I then <a rel="noreferrer noopener" href="https://github.com/Roger-random/mitutoyo" target="_blank">released my derivative publicly on GitHub</a> with the following changes:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul id="block-0171fa3b-004e-4f52-b015-8deb154460fc">
<li>Calculate distance within numeric domain instead of converting to string and back.</li>
<li>Decimal point placement with a single math expression instead of a list of six <code>if</code> statements.</li>
<li>Their code didn't output if value is inch or millimeter, I added units.</li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p id="block-7c14a9a8-720c-4a36-bd8a-869a0f40fb27">A limitation of their code (that I did not fix) is a recovery path, should the Arduino falls out of sync. The Mitutoyo protocol was designed with a recovery provision: If the communication gets out of sync, we can sync back up using the opening 0xFFFF. But since there's no code watching for that situation, if it falls out of sync our code would just be permanently confused until reset by the user.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p id="block-858616cf-9796-4976-8ff6-cb7fde120692">For debugging I added the capability to output in raw hex. I was going to remove it once I had the distance calculation and decimal point code figured out, but I left it in place as a compile-time parameter just in case that would become handy in the future. Sending just hexadecimal data and skipping conversion to human-readable text would allow faster loops.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p id="block-f79bb76a-dbd0-4627-860b-f10a107a65e4">Note that this Mitutoyo Statistical Process Control (SPC) protocol has no interactive control -- it just reports whatever is on the display. Switching units, switching direction, zeroing, all such functions are done through device buttons.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p id="block-c49c4bb4-add7-4ac5-b83c-cb5adb4e0f21">Once it all appears to work on the prototyping breadboard, I again soldered up a compact version and put it inside a custom 3D printed enclosure.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image --></p>
<figure class="wp-block-image" id="block-03044e14-bf1e-47d0-9617-1164d2b7f57c"><img src="https://newscrewdriver.com/wp-content/uploads/2020/07/mitutoyo-spc-arduino-compact.jpg?w=1024" alt="This image has an empty alt attribute; its file name is mitutoyo-spc-arduino-compact.jpg"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:embed {"url":"https:\/\/twitter.com\/Regorlas\/status\/1289256790341763073","type":"rich","providerNameSlug":"twitter","responsive":true,"className":""} --></p>
<figure class="wp-block-embed is-type-rich is-provider-twitter wp-block-embed-twitter">
<div class="wp-block-embed__wrapper">
https://twitter.com/Regorlas/status/1289256790341763073
</div>
</figure>
<p><!-- /wp:embed --></p>
<p><!-- wp:image {"id":24222,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="https://newscrewdriver.com/wp-content/uploads/2020/12/mitutoyp-spc-arduino-serial-schematic.png?w=1024" alt="" class="wp-image-24222"></figure>
<p><!-- /wp:image --><br />
</body></html></p>
