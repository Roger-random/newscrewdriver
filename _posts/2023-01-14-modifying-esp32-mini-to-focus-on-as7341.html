---
layout: post
title: Modifying ESP32 Mini to Focus on AS7341
date: 2023-01-14 12:30:00.000000000 +00:00
type: post
post_id: '34582'
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Projects
tags:
- Arduino
- AS7341
- ESP32
meta:
  _last_editor_used_jetpack: block-editor
  _thumbnail_id: '34583'
  wordads_ufa: s:wpcom-ufa-v3-beta:1683101559
  _publicize_job_id: '80550344823'
  timeline_notification: '1673728219'
  _elasticsearch_data_sharing_indexed_on: '2024-11-18 13:33:55'
author:
  login: inkarc
  email: luxo.lamp@gmail.com
  display_name: Roger Cheng
  first_name: Roger
  last_name: Cheng
permalink: "/2023/01/14/modifying-esp32-mini-to-focus-on-as7341/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<!-- wp:paragraph --><html><body></p>
<p>In order to eliminate Mozzi audio glitches while reading AS7341 spectral color sensor, I was prepared to dive down to learn ESP-IDF I2C API. Fortunately, it turned out Adafruit AS7341 library's provision for asynchronous read (sensor integration occurs while Arduino code continues running) <a href="https://newscrewdriver.com/2023/01/13/performing-as7341-sensor-integration-in-parallel-resolved-mozzi-glitches/">was good enough to eliminate those popping noises</a>. This brought one project to a rapid conclusion so I can contemplate my next one.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>I've barely scratched the surface of this AS7341's capabilities, and I still haven't quite grasped the meaning of all those numbers that it generated. I don't have an intuitive grasp of how the set of numbers generated by this sensor relates to how human eyes perceive color. I want to further explore the AS7341 and take it around the house to measure different things, but the contraption I have on hand is quite cumbersome with its STEMMA QT compatible wiring for the AS7341 and a salvaged 3.5mm jack for connecting an audio cable.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>To focus on AS7341, I will leave the audio subsystem behind for my next set of experiments. After I unsoldered the 3.5mm jack for audio output, I am much less likely to catch an inconvenient wire and risk damaging my test circuit. I then wrapped the ESP32 mini and wires to the AS7341 sensor inside a bit of <a rel="noreferrer noopener" href="https://amzn.to/3GOAEk9" target="_blank">clear heat-shrink tube</a> (*) so I am no longer handling bare circuit board. The micro-USB connector would serve as the best metal contact point for grounding purposes, so it was left outside of the shrink-wrapped area as was the reset button that should remain accessible.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>(If this is all I wanted to do, and I knew this to begin with, I would have used something like an <a rel="noreferrer noopener" href="https://www.adafruit.com/product/5395" target="_blank">Adafruit QT Py ESP32 Pico</a>. But I'm sure I will want to do more down the line, and I'm making it up as I go along.)</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"align":"center","id":34589,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image aligncenter size-large"><img src="https://newscrewdriver.com/wp-content/uploads/2023/01/adafruit-as7341-green-power-led.jpg?w=1024" alt="" class="wp-image-34589"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>In addition to a large white LED intended to provide illumination for the color sensor, Adafruit's AS7341 board also has a bright green LED to indicate power. I'm worried this LED's green light might distort color sensor results. I like the idea of a power LED indicator, but I would have much rather preferred a dim green glow over this bright beacon. [In contrast, <a rel="noreferrer noopener" href="https://newscrewdriver.com/2023/01/02/window-shopping-dfrobot-as7341-board/" target="_blank">DFRobot's AS7341 board</a> does not have a bright LED close to the sensor.]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"align":"center","id":34591,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image aligncenter size-large"><img src="https://newscrewdriver.com/wp-content/uploads/2023/01/adafruit-as7341-green-power-led-servo-tape.jpg?w=1024" alt="" class="wp-image-34591"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>I thought about unsoldering either the LED itself or its adjacent current-limiting resistor, but they are right next to a STEMMA QT connector and I think my hot-air gun would melt and damage its plastic. Then I had a better idea: I put on a small piece of double-sided foam tape. ("Servo tape" from the world of remote-control hobby.) It is an easily reversible modification that blocked majority of green light, good enough to let me <a href="https://newscrewdriver.com/2023/01/15/new-project-as7341-interactive-web-ui/">contemplate the software side of my next project</a>.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>[UPDATE: As of April 26, 2023 Adafruit has updated this product with a cuttable jumper to disable power LED.]</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:separator --></p>
<hr class="wp-block-separator has-alpha-channel-opacity">
<!-- /wp:separator --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">(*) Disclosure: As an Amazon Associate I earn from qualifying purchases.</p>
<p><!-- /wp:paragraph --><br />
</body></html></p>
