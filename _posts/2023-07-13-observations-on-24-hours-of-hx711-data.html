---
layout: post
title: Observations on 24 Hours of HX711 Data
date: 2023-07-13 12:30:00.000000000 +00:00
type: post
post_id: '37899'
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Projects
tags:
- ESPHome
meta:
  _last_editor_used_jetpack: block-editor
  _thumbnail_id: '37900'
  wordads_ufa: s:wpcom-ufa-v3-beta:1689366315
  _publicize_job_id: '85716854547'
  timeline_notification: '1689276608'
  _oembed_a3f5c39e64ca339ac27522615cd9b303: <div class="embed-amazon"><iframe title="Single
    Point Beam Load Cell Compression Force Testing Platform Scale Sensor NA1 NA2 NA4
    NA4 3 5 10 20 30 40 50 60 100 200 300 350 500 1000 1200KG" type="text/html" width="700"
    height="550" frameborder="0" allowfullscreen style="max-width:100%" src="https://read.amazon.com/kp/card?preview=inline&linkCode=kpd&ref_=k4w_oembed_34a9F6wrhcE0kg&asin=B0B6J2KH1Y&tag=kpembed-20"></iframe></div>
  _oembed_time_a3f5c39e64ca339ac27522615cd9b303: '1704186015'
  _oembed_d2bd9f54f8386f5fa7345b12c55a108e: <div class="embed-amazon"><iframe title="Single
    Point Beam Load Cell Compression Force Testing Platform Scale Sensor NA1 NA2 NA4
    NA4 3 5 10 20 30 40 50 60 100 200 300 350 500 1000 1200KG" type="text/html" width="500"
    height="550" frameborder="0" allowfullscreen style="max-width:100%" src="https://read.amazon.com/kp/card?preview=inline&linkCode=kpd&ref_=k4w_oembed_bOXmTsqnMVP0uZ&asin=B0B6J2KH1Y&tag=kpembed-20"></iframe></div>
  _oembed_time_d2bd9f54f8386f5fa7345b12c55a108e: '1704331617'
  _elasticsearch_data_sharing_indexed_on: '2024-11-18 13:35:40'
author:
  login: inkarc
  email: luxo.lamp@gmail.com
  display_name: Roger Cheng
  first_name: Roger
  last_name: Cheng
permalink: "/2023/07/13/observations-on-24-hours-of-hx711-data/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<!-- wp:paragraph --><html><body></p>
<p>I dusted off my inexpensive load cell system (read by a HX711 chip) and <a href="https://newscrewdriver.com/2023/07/12/next-load-cell-experiment-will-be-on-esphome/">switched the associated microcontroller from an Arduino Nano to an ESP8266</a>. That ESP8266 was then programmed using ESPHome to upload load cell readings to my Home Assistant server. I configured the ESP8266 to read every half second, but I've learned sending that much raw data directly to Home Assistant <a href="https://newscrewdriver.com/2022/02/24/esphome-sensor-filters-help-manage-flood-of-data/">bogs down the system</a> so that twice-a-second data is filtered to a summary report once a minute.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">General Noise</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>One summary is generated by a small code snippet I wrote tracking the difference between <a href="https://newscrewdriver.com/2022/03/26/recording-esphome-sensor-values-min-max-and-average/">maximum and minimum values</a> seen within that minute. This gives me an idea of the natural level of noise in my particular configuration. If all other variables are unchanged, I saw a fluctuation of roughly 350 sensor counts, mostly within the range from 250 to 450.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The other summary is an average. Since I already had code tracking maximum and minimum, it wouldn't have been hard to calculate my own average. But rather than adding those 3-5 lines of code, I used ESPHome's built-in <a href="https://esphome.io/components/sensor/index.html#sliding-window-moving-average">sliding window moving average</a> filter because it was already there. Keeping the system running for a little over 24 hours, here's the graph it generated:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"align":"center","id":37900,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image aligncenter size-large"><img src="https://newscrewdriver.com/wp-content/uploads/2023/07/load-cell-hx711-24-hour-observations.png?w=1024" alt="" class="wp-image-37900"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Spurious Data</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>The little spikes visible in this graph are caused by the occasional data that does not reflect reality. I saw this in my earlier experiments with the HX711 talking to Node-RED, but that only ran for a few minutes at a time. I had hoped that, by graphing its behavior over a day, I could observe some pattern.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul>
<!-- wp:list-item --></p>
<li>There was no frequency-based pattern I could detect: they can happen mere minutes apart, and sometimes I can go for hours without one.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>I only have a single day, which is not enough data to say if there's a time-of-day pattern.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Visible spikes in the graph were caused by nonsensical values indicating less weight than when the load cell is completely unloaded: negative weight, so to speak. The raw sensor count is usually in the few thousands range when unloaded is approximately -420,000, a big enough difference to visibly throw off the average over 120 readings.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Even though "negative weight" is the most visible in this graph, there are also unexplained brief flashes of data in the positive weight domain, they just don't throw off the average value as visibly on this plot.</li>
<p><!-- /wp:list-item -->
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Temperature Sensitivity</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>One behavior I never noticed during my short duration Node-RED experiments were the relation between sensor counts and temperature. With a full day's worth of data plotted, the correlation is clearly visible. From around 7PM to 8AM the next day, temperature dropped from 28.2°C to 21.6°C. (Tracked elsewhere in my Home Assistant network, not on this graph.) During this 6.6°C drop, average sensor count rose from around -426,500 to -420,000. This rounds to approximately 1000 sensor counts per degree Celsius.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Kilogram Test</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>But what do those sensor counts correspond to? I used my kitchen scale to measure as I poured water into a jar, stopping when they weighed one kilogram together. I placed that on my test setup for two hours. This dropped sensor counts from around -420,000 to -443,000 (plus temperature-induced variation). Using 23,000 sensor counts per kilogram, I can tentatively guess the random noise of ~300 sensor counts correspond to roughly thirteen grams. This is consistent with <a href="https://newscrewdriver.com/2020/09/08/surprising-precision-and-consistency-from-load-cell/">my earlier observation</a> I need roughly fifteen grams of weight change before it is barely distinguishable from noise.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>By the same metric, temperature change for a single degree Celsius changes the reading by roughly 43 grams. Over the course of a day that varies by 6.6 degrees Celsius, that would change weight reading by roughly 280 grams.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">System Warmup</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>I brainstormed on possible reasons for spurious data and thought perhaps they were caused by the JST-XH connectors I used. A small intermittent connection might not be noticed in most of my projects, but load cells work by slight changes in resistance and the HX711 amplifies those changes. Small flaws in a connector that would go unnoticed elsewhere would drastically change behavior here, so I unsoldered the connector and soldered all wires directly to the HX711 board.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>That experiment was a bust, direct soldering did not eliminate spurious data. I still don't know where that's coming from. But I came out of it with an additional observation: When I disconnect the system for a while to work on it, then turn it back on, there's a warmup curve visible on the plot. This graph had two such work sessions, and I see a curve of roughly 3000 sensor counts. That's roughly 130 grams.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Conclusion</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Based on these observations, I conclude this specific load cell setup is only dependable down to about half a kilogram before we have to worry about compensating for factors system warmup or ambient temperature. This is consistent with the primary use of these devices: inexpensive bathroom scales for measuring human body weight.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>We also need to account for spurious data in some way, for example take multiple readings and average them, possibly ignoring readings that are wildly inconsistent with the rest.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>And even if we somehow managed to compensate for environment variables, it's not possible to reliably measure any changes less than ~20 grams because of fundamental noise in this system. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This isn't bad for a $10 kit, but its limitations does constrain usefulness. After a bit of thought, I think I have <a href="https://newscrewdriver.com/2023/07/14/load-cells-for-sleep-activity-logging/">a good project idea to fit this sensor</a>.</p>
<p><!-- /wp:paragraph --><br />
</body></html></p>
