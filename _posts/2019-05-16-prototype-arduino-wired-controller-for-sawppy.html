---
layout: post
title: Prototype Arduino Wired Controller For Sawppy
date: 2019-05-16 12:30:30.000000000 +00:00
type: post
post_id: '18494'
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Arduino
- Sawppy the Rover
tags: []
meta:
  _thumbnail_id: '18487'
  _oembed_80b2afe2a1e79dfa70128e364388d030: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="500" data-dnt="true"><p lang="en" dir="ltr">Fun
    with trigonometry tonight! Reviewing <a href="https://twitter.com/hashtag/Sawppy?src=hash&amp;ref_src=twsrc%5Etfw">#Sawppy</a>
    wheel geometry on paper to help track down problems with my Arduino control code.
    <a href="https://t.co/22A4VrLbjC">pic.twitter.com/22A4VrLbjC</a></p>&mdash; Roger
    Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1127079594022948866?ref_src=twsrc%5Etfw">May
    11, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_80b2afe2a1e79dfa70128e364388d030: '1557873977'
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  _oembed_b7b1acd8853cb7242794f511f645f705: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Fun
    with trigonometry tonight! Reviewing <a href="https://twitter.com/hashtag/Sawppy?src=hash&amp;ref_src=twsrc%5Etfw">#Sawppy</a>
    wheel geometry on paper to help track down problems with my Arduino control code.
    <a href="https://t.co/22A4VrLbjC">pic.twitter.com/22A4VrLbjC</a></p>&mdash; Roger
    Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1127079594022948866?ref_src=twsrc%5Etfw">May
    11, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_7e8324107221a1bf31a50dd86cdc49c8: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Fun
    with trigonometry tonight! Reviewing <a href="https://twitter.com/hashtag/Sawppy?src=hash&amp;ref_src=twsrc%5Etfw">#Sawppy</a>
    wheel geometry on paper to help track down problems with my Arduino control code.
    <a href="https://t.co/22A4VrLbjC">pic.twitter.com/22A4VrLbjC</a></p>&mdash; Roger
    Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1127079594022948866?ref_src=twsrc%5Etfw">May
    11, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_7e8324107221a1bf31a50dd86cdc49c8: '1558035253'
  _publicize_job_id: '30879632103'
  timeline_notification: '1558035254'
  _oembed_5d2b8a7e8c31178042d620293276392c: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Fun
    with trigonometry tonight! Reviewing <a href="https://twitter.com/hashtag/Sawppy?src=hash&amp;ref_src=twsrc%5Etfw">#Sawppy</a>
    wheel geometry on paper to help track down problems with my Arduino control code.
    <a href="https://t.co/22A4VrLbjC">pic.twitter.com/22A4VrLbjC</a></p>&mdash; Roger
    Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1127079594022948866?ref_src=twsrc%5Etfw">May
    11, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_5d2b8a7e8c31178042d620293276392c: '1558035255'
  _oembed_time_b7b1acd8853cb7242794f511f645f705: '1558035268'
  wordads_ufa: s:wpcom-ufa-v3-beta:1667551004
  _oembed_99178787eb2ac16a9d4aeb731e9b8579: <div class="embed-twitter"><blockquote
    class="twitter-tweet" data-width="550" data-dnt="true"><p lang="en" dir="ltr">Fun
    with trigonometry tonight! Reviewing <a href="https://twitter.com/hashtag/Sawppy?src=hash&amp;ref_src=twsrc%5Etfw">#Sawppy</a>
    wheel geometry on paper to help track down problems with my Arduino control code.
    <a href="https://t.co/22A4VrLbjC">pic.twitter.com/22A4VrLbjC</a></p>&mdash; Roger
    Cheng (@Regorlas) <a href="https://twitter.com/Regorlas/status/1127079594022948866?ref_src=twsrc%5Etfw">May
    11, 2019</a></blockquote><script async src="https://platform.twitter.com/widgets.js"
    charset="utf-8"></script></div>
  _oembed_time_99178787eb2ac16a9d4aeb731e9b8579: '1708471079'
  _elasticsearch_data_sharing_indexed_on: '2024-11-18 13:24:32'
author:
  login: inkarc
  email: luxo.lamp@gmail.com
  display_name: Roger Cheng
  first_name: Roger
  last_name: Cheng
permalink: "/2019/05/16/prototype-arduino-wired-controller-for-sawppy/"
---
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"><br />
<html><body>
<p>Once I had <a href="https://newscrewdriver.com/2019/05/15/arduino-control-of-lewansoul-lx-16a-servo-via-joystick-commands/">basic control of LewanSoul LX-16A serial bus servo via analog joystick with an Arduino Uno</a>, it was time to write code to perform trigonometry math necessary to calculate <a href="https://en.wikipedia.org/wiki/Ackermann_steering_geometry">Ackerman steering angle</a> and speed for each of Sawppy's six wheels. Conceptually this is a port of code <a href="https://github.com/Roger-random/SGVHAK_Rover/blob/master/SGVHAK_Rover/roverchassis.py">I wrote for the SGVHAK Rover project</a>. However, that had the benefit Python, a high level friendly language.</p>
<p>The first concern came from reviewing <a href="https://www.arduino.cc/reference/en/">Arduino Language Reference</a> page. Under <em>Trigonometry</em> section it lists cosine, sine, and tangent functions but I didn't see their counterparts arccosine, arcsine, and arctangent which I needed. I was never worried that I might have to reimplement my own math library: surely one would exist! They're too useful and the Arduino ecosystem is too large for them not to.</p>
<p>It turned out I didn't have to go very far in my search: underneath all the beginner-friendliness the board still runs an ATmega328 chip of the AVR microcontroller product line. And Arduino has not deviated from core language for programming that chip, so I could pull in the <a href="https://www.microchip.com/webdoc/AVRLibcReferenceManual/group__avr__math.html">standard AVR <code>&lt;math.h&gt;</code> library</a> to gain <a href="https://www.microchip.com/webdoc/AVRLibcReferenceManual/group__avr__math_1gae9c5790d8a29cbee8f54f8eb522decbc.html"><code>acos()</code></a>, <a href="https://www.microchip.com/webdoc/AVRLibcReferenceManual/group__avr__math_1ga98384ad60834911ec93ac5ae1af4cf0a.html"><code>asin()</code></a> and <a href="https://www.microchip.com/webdoc/AVRLibcReferenceManual/group__avr__math_1ga3abd1a0b68d157914a0ee01acaedfe5e.html"><code>atan()</code></a> functions.</p>
<p>I only had to duplicate the math for an Arduino counterpart, I didn't try to replicate all the features of my Python code since some of them relied on the nature of Python for their flexibility. Still, even with the simplifications (or possibly because of them?) the code was different enough for some bugs to slip in. I ended up retracing through my steps using pen and paper to debug a few problems.</p>
<p>Once debugged, I had a crude wired controller for Sawppy. An analog joystick connected to my Arduino Uno with jumper wires provides user input. My freshly written code translates the joystick position to four corner steering angles and six wheel velocities, and sends out commands to all ten LewanSoul serial bus servos using Arduino's UART TX pin connected to LewanSoul BusLinker via another pair of jumper wires.</p>
<p>Next task: make this Arduino wired controller more compact and more reliable with soldered wire connections to replace these jumper wires.</p>
<p>(Code for this project is publicly available in the <a href="https://github.com/Roger-random/Sawppy_Rover/tree/master/arduino_sawppy"><code>arduino_sawppy</code> subdirectory</a> of Sawppy Rover's Github repository.)</p>
<p>https://twitter.com/Regorlas/status/1127079594022948866</p>
<p></body></html></p>
